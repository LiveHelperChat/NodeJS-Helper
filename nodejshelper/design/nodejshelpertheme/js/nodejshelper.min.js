!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).socketCluster=t()}(function(){return function n(o,i,s){function a(e,t){if(!i[e]){if(!o[e]){var r="function"==typeof require&&require;if(!t&&r)return r(e,!0);if(c)return c(e,!0);throw(r=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",r}r=i[e]={exports:{}},o[e][0].call(r.exports,function(t){return a(o[e][1][t]||t)},r,r.exports,n,o,i,s)}return i[e].exports}for(var c="function"==typeof require&&require,t=0;t<s.length;t++)a(s[t]);return a}({1:[function(t,e,r){var n=t("./lib/scclientsocket"),o=t("./lib/factory");e.exports.factory=o,e.exports.SCClientSocket=n,e.exports.Emitter=t("component-emitter"),e.exports.create=function(t){return o.create(t)},e.exports.connect=e.exports.create,e.exports.destroy=function(t){return o.destroy(t)},e.exports.clients=o.clients,e.exports.version="13.0.1"},{"./lib/factory":3,"./lib/scclientsocket":5,"component-emitter":12}],2:[function(t,e,r){!function(o){function t(){this._internalStorage={},this.isLocalStorageEnabled=this._checkLocalStorageEnabled()}t.prototype._checkLocalStorageEnabled=function(){var e;try{o.localStorage,o.localStorage.setItem("__scLocalStorageTest",1),o.localStorage.removeItem("__scLocalStorageTest")}catch(t){e=t}return!e},t.prototype.saveToken=function(t,e,r,n){this.isLocalStorageEnabled&&o.localStorage?o.localStorage.setItem(t,e):this._internalStorage[t]=e,n&&n(null,e)},t.prototype.removeToken=function(t,e){var r;this.loadToken(t,function(t,e){r=e}),this.isLocalStorageEnabled&&o.localStorage?o.localStorage.removeItem(t):delete this._internalStorage[t],e&&e(null,r)},t.prototype.loadToken=function(t,e){t=this.isLocalStorageEnabled&&o.localStorage?o.localStorage.getItem(t):this._internalStorage[t]||null;e(null,t)},e.exports.AuthEngine=t}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,r,t){!function(s){var a=e("./scclientsocket"),t=e("sc-errors"),c=e("uuid"),u=t.InvalidArgumentsError,h={};r.exports={create:function(t){if((t=t||{}).host&&!t.host.match(/[^:]+:\d{2,5}/))throw new u('The host option should include both the hostname and the port number in the format "hostname:port"');if(t.host&&t.hostname)throw new u('The host option should already include the hostname and the port number in the format "hostname:port" - Because of this, you should never use host and hostname options together');if(t.host&&t.port)throw new u('The host option should already include the hostname and the port number in the format "hostname:port" - Because of this, you should never use host and port options together');var e,r,n,o=s.location&&"https:"==location.protocol,i={port:(r=o,r=null==(e=t).secure?r:e.secure,e.port||(s.location&&location.port?location.port:r?443:80)),hostname:s.location&&location.hostname||"localhost",path:"/socketcluster/",secure:o,autoConnect:!0,autoReconnect:!0,autoSubscribeOnConnect:!0,connectTimeout:2e4,ackTimeout:1e4,timestampRequests:!1,timestampParam:"t",authEngine:null,authTokenName:"socketCluster.authToken",binaryType:"arraybuffer",multiplex:!0,pubSubBatchDuration:null,cloneData:!1};for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);return i.clientMap=h,!1!==i.multiplex?(i.clientId=function(t){var e=t.secure?"https://":"http://",r="";if(t.query)if("string"==typeof t.query)r=t.query;else{var n,o=[],i=t.query;for(n in i)i.hasOwnProperty(n)&&o.push(n+"="+i[n]);o.length&&(r="?"+o.join("&"))}return e+(t.host||t.hostname+":"+t.port)+t.path+r}(i),h[i.clientId]?i.autoConnect&&h[i.clientId].connect():h[i.clientId]=new a(i),h[i.clientId]):(i.clientId=c.v4(),o=new a(i),h[i.clientId]=o)},destroy:function(t){t.destroy()},clients:h}}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./scclientsocket":5,"sc-errors":21,uuid:23}],4:[function(t,e,r){var n=t("sc-errors"),o=n.InvalidActionError,t=function(t,e){this.socket=t,this.id=e,this.sent=!1};t.prototype._respond=function(t){if(this.sent)throw new o("Response "+this.id+" has already been sent");this.sent=!0,this.socket.send(this.socket.encode(t))},t.prototype.end=function(t){var e;this.id&&(e={rid:this.id},void 0!==t&&(e.data=t),this._respond(e))},t.prototype.error=function(t,e){this.id&&(t=n.dehydrateError(t),t={rid:this.id,error:t},void 0!==e&&(t.data=e),this._respond(t))},t.prototype.callback=function(t,e){t?this.error(t,e):this.end(e)},e.exports.Response=t},{"sc-errors":21}],5:[function(v,w,t){!function(o,e){function n(t){var e=this;i.call(this),this.id=null,this.state=this.CLOSED,this.authState=this.UNAUTHENTICATED,this.signedAuthToken=null,this.authToken=null,this.pendingReconnect=!1,this.pendingReconnectTimeout=null,this.preparingPendingSubscriptions=!1,this.clientId=t.clientId,this.connectTimeout=t.connectTimeout,this.ackTimeout=t.ackTimeout,this.channelPrefix=t.channelPrefix||null,this.disconnectOnUnload=null==t.disconnectOnUnload||t.disconnectOnUnload,this.authTokenName=t.authTokenName,this.pingTimeout=this.ackTimeout,this.pingTimeoutDisabled=!!t.pingTimeoutDisabled,this.active=!0,this._clientMap=t.clientMap||{};var r=Math.pow(2,31)-1,n=function(t){if(e[t]>r)throw new d("The "+t+" value provided exceeded the maximum amount allowed")};n("connectTimeout"),n("ackTimeout"),this._localEvents={connect:1,connectAbort:1,close:1,disconnect:1,message:1,error:1,raw:1,kickOut:1,subscribe:1,unsubscribe:1,subscribeStateChange:1,authStateChange:1,authenticate:1,deauthenticate:1,removeAuthToken:1,subscribeRequest:1},this.connectAttempts=0,this._emitBuffer=new h,this.channels={},this.options=t,this._cid=1,this.options.callIdGenerator=function(){return e._cid++},this.options.autoReconnect&&(null==this.options.autoReconnectOptions&&(this.options.autoReconnectOptions={}),null==(n=this.options.autoReconnectOptions).initialDelay&&(n.initialDelay=1e4),null==n.randomness&&(n.randomness=1e4),null==n.multiplier&&(n.multiplier=1.5),null==n.maxDelay&&(n.maxDelay=6e4)),null==this.options.subscriptionRetryOptions&&(this.options.subscriptionRetryOptions={}),this.options.authEngine?this.auth=this.options.authEngine:this.auth=new a,this.options.codecEngine?this.codec=this.options.codecEngine:this.codec=c,this.options.path=this.options.path.replace(/\/$/,"")+"/",this.options.query=t.query||{},"string"==typeof this.options.query&&(this.options.query=u.parse(this.options.query)),this._channelEmitter=new i,this._unloadHandler=function(){e.disconnect()},E&&this.disconnectOnUnload&&o.addEventListener&&o.addEventListener("beforeunload",this._unloadHandler,!1),(this._clientMap[this.clientId]=this).options.autoConnect&&this.connect()}var i=v("component-emitter"),s=v("sc-channel").SCChannel,a=(v("./response").Response,v("./auth").AuthEngine),c=v("sc-formatter"),r=v("./sctransport").SCTransport,u=v("querystring"),h=v("linked-list"),p=v("base-64"),l=v("clone"),f=v("sc-errors"),d=f.InvalidArgumentsError,t=f.InvalidMessageError,y=f.InvalidActionError,g=f.SocketProtocolError,m=f.TimeoutError,b=f.BadConnectionError,E="undefined"!=typeof window;n.prototype=Object.create(i.prototype),n.CONNECTING=n.prototype.CONNECTING=r.prototype.CONNECTING,n.OPEN=n.prototype.OPEN=r.prototype.OPEN,n.CLOSED=n.prototype.CLOSED=r.prototype.CLOSED,n.AUTHENTICATED=n.prototype.AUTHENTICATED="authenticated",n.UNAUTHENTICATED=n.prototype.UNAUTHENTICATED="unauthenticated",n.PENDING=n.prototype.PENDING="pending",n.ignoreStatuses=f.socketProtocolIgnoreStatuses,n.errorStatuses=f.socketProtocolErrorStatuses,n.prototype._privateEventHandlerMap={"#publish":function(t){var e=this._undecorateChannelName(t.channel);this.isSubscribed(e,!0)&&this._channelEmitter.emit(e,t.data)},"#kickOut":function(t){var e=this._undecorateChannelName(t.channel),r=this.channels[e];r&&(i.prototype.emit.call(this,"kickOut",t.message,e),r.emit("kickOut",t.message,e),this._triggerChannelUnsubscribe(r))},"#setAuthToken":function(e,r){var n=this;e?this.auth.saveToken(this.authTokenName,e.token,{},function(t){t?(r.error(t),n._onSCError(t)):(n._changeToAuthenticatedState(e.token),r.end())}):r.error(new t("No token data provided by #setAuthToken event"))},"#removeAuthToken":function(t,r){var n=this;this.auth.removeToken(this.authTokenName,function(t,e){t?(r.error(t),n._onSCError(t)):(i.prototype.emit.call(n,"removeAuthToken",e),n._changeToUnauthenticatedStateAndClearTokens(),r.end())})},"#disconnect":function(t){this.transport.close(t.code,t.data)}},n.prototype.getState=function(){return this.state},n.prototype.getBytesReceived=function(){return this.transport.getBytesReceived()},n.prototype.deauthenticate=function(r){var n=this;this.auth.removeToken(this.authTokenName,function(t,e){t?n._onSCError(t):(i.prototype.emit.call(n,"removeAuthToken",e),n.state!=n.CLOSED&&n.emit("#removeAuthToken"),n._changeToUnauthenticatedStateAndClearTokens()),r&&r(t)})},n.prototype.connect=n.prototype.open=function(){var t,n=this;this.active?this.state==this.CLOSED&&(this.pendingReconnect=!1,this.pendingReconnectTimeout=null,clearTimeout(this._reconnectTimeoutRef),this.state=this.CONNECTING,i.prototype.emit.call(this,"connecting"),this.transport&&this.transport.off(),this.transport=new r(this.auth,this.codec,this.options),this.transport.on("open",function(t){n.state=n.OPEN,n._onSCOpen(t)}),this.transport.on("error",function(t){n._onSCError(t)}),this.transport.on("close",function(t,e){n.state=n.CLOSED,n._onSCClose(t,e)}),this.transport.on("openAbort",function(t,e){n.state=n.CLOSED,n._onSCClose(t,e,!0)}),this.transport.on("event",function(t,e,r){n._onSCEvent(t,e,r)})):(t=new y("Cannot connect a destroyed client"),this._onSCError(t))},n.prototype.reconnect=function(t,e){this.disconnect(t,e),this.connect()},n.prototype.disconnect=function(t,e){if("number"!=typeof(t=t||1e3))throw new d("If specified, the code argument must be a number");this.state==this.OPEN||this.state==this.CONNECTING?this.transport.close(t,e):(this.pendingReconnect=!1,this.pendingReconnectTimeout=null,clearTimeout(this._reconnectTimeoutRef))},n.prototype.destroy=function(t,e){E&&o.removeEventListener&&o.removeEventListener("beforeunload",this._unloadHandler,!1),this.active=!1,this.disconnect(t,e),delete this._clientMap[this.clientId]},n.prototype._changeToUnauthenticatedStateAndClearTokens=function(){var t,e;this.authState!=this.UNAUTHENTICATED&&(e=this.authState,t=this.signedAuthToken,this.authState=this.UNAUTHENTICATED,this.signedAuthToken=null,this.authToken=null,e={oldState:e,newState:this.authState},i.prototype.emit.call(this,"authStateChange",e),i.prototype.emit.call(this,"deauthenticate",t))},n.prototype._changeToAuthenticatedState=function(t){var e;this.signedAuthToken=t,this.authToken=this._extractAuthTokenData(t),this.authState!=this.AUTHENTICATED&&(e=this.authState,this.authState=this.AUTHENTICATED,e={oldState:e,newState:this.authState,signedAuthToken:t,authToken:this.authToken},this.preparingPendingSubscriptions||this.processPendingSubscriptions(),i.prototype.emit.call(this,"authStateChange",e)),i.prototype.emit.call(this,"authenticate",t)},n.prototype.decodeBase64=function(t){return void 0===e?o.atob?o.atob(t):p.decode(t):new e(t,"base64").toString("utf8")},n.prototype.encodeBase64=function(t){return void 0===e?o.btoa?o.btoa(t):p.encode(t):new e(t,"utf8").toString("base64")},n.prototype._extractAuthTokenData=function(e){e=(e||"").split(".")[1];if(null!=e){e=e;try{return e=this.decodeBase64(e),JSON.parse(e)}catch(t){return e}}return null},n.prototype.getAuthToken=function(){return this.authToken},n.prototype.getSignedAuthToken=function(){return this.signedAuthToken},n.prototype.authenticate=function(r,n){var o=this;this.emit("#authenticate",r,function(t,e){e&&null!=e.isAuthenticated?e.authError&&(e.authError=f.hydrateError(e.authError)):e={isAuthenticated:o.authState,authError:null},t?("BadConnectionError"!=t.name&&"TimeoutError"!=t.name&&o._changeToUnauthenticatedStateAndClearTokens(),n&&n(t,e)):o.auth.saveToken(o.authTokenName,r,{},function(t){t&&o._onSCError(t),e.isAuthenticated?o._changeToAuthenticatedState(r):o._changeToUnauthenticatedStateAndClearTokens(),n&&n(t,e)})})},n.prototype._tryReconnect=function(t){var e,r=this,n=this.connectAttempts++,o=this.options.autoReconnectOptions;(t=null==t||0<n?(e=Math.round(o.initialDelay+(o.randomness||0)*Math.random()),Math.round(e*Math.pow(o.multiplier,n))):t)>o.maxDelay&&(t=o.maxDelay),clearTimeout(this._reconnectTimeoutRef),this.pendingReconnect=!0,this.pendingReconnectTimeout=t,this._reconnectTimeoutRef=setTimeout(function(){r.connect()},t)},n.prototype._onSCOpen=function(t){var e=this;this.preparingPendingSubscriptions=!0,t?(this.id=t.id,this.pingTimeout=t.pingTimeout,this.transport.pingTimeout=this.pingTimeout,t.isAuthenticated?this._changeToAuthenticatedState(t.authToken):this._changeToUnauthenticatedStateAndClearTokens()):this._changeToUnauthenticatedStateAndClearTokens(),this.connectAttempts=0,this.options.autoSubscribeOnConnect&&this.processPendingSubscriptions(),i.prototype.emit.call(this,"connect",t,function(){e.processPendingSubscriptions()}),this.state==this.OPEN&&this._flushEmitBuffer()},n.prototype._onSCError=function(t){var e=this;setTimeout(function(){if(e.listeners("error").length<1)throw t;i.prototype.emit.call(e,"error",t)},0)},n.prototype._suspendSubscriptions=function(){var t,e,r;for(r in this.channels)this.channels.hasOwnProperty(r)&&(e=(t=this.channels[r]).state==t.SUBSCRIBED||t.state==t.PENDING?t.PENDING:t.UNSUBSCRIBED,this._triggerChannelUnsubscribe(t,e))},n.prototype._abortAllPendingEventsDueToBadConnection=function(t){for(var e=this._emitBuffer.head;e;){var r=e.next,n=e.data;clearTimeout(n.timeout),delete n.timeout,e.detach();var e=r,o=n.callback;o&&(delete n.callback,r="Event '"+n.event+"' was aborted due to a bad connection",r=new b(r,t),o.call(n,r,n)),n.cid&&this.transport.cancelPendingResponse(n.cid)}},n.prototype._onSCClose=function(t,e,r){this.id=null,this.transport&&this.transport.off(),this.pendingReconnect=!1,this.pendingReconnectTimeout=null,clearTimeout(this._reconnectTimeoutRef),this._suspendSubscriptions(),this._abortAllPendingEventsDueToBadConnection(r?"connectAbort":"disconnect"),this.options.autoReconnect&&(4e3==t||4001==t||1005==t?this._tryReconnect(0):1e3!=t&&t<4500&&this._tryReconnect()),r?i.prototype.emit.call(this,"connectAbort",t,e):i.prototype.emit.call(this,"disconnect",t,e),i.prototype.emit.call(this,"close",t,e),n.ignoreStatuses[t]||(e=e?"Socket connection closed with status code "+t+" and reason: "+e:"Socket connection closed with status code "+t,t=new g(n.errorStatuses[t]||e,t),this._onSCError(t))},n.prototype._onSCEvent=function(t,e,r){var n=this._privateEventHandlerMap[t];n?n.call(this,e,r):i.prototype.emit.call(this,t,e,function(){r&&r.callback.apply(r,arguments)})},n.prototype.decode=function(t){return this.transport.decode(t)},n.prototype.encode=function(t){return this.transport.encode(t)},n.prototype._flushEmitBuffer=function(){for(var t=this._emitBuffer.head;t;){var e=t.next,r=t.data;t.detach(),this.transport.emitObject(r),t=e}},n.prototype._handleEventAckTimeout=function(t,e){e&&e.detach(),delete t.timeout;var r=t.callback;r&&(delete t.callback,e=new m("Event response for '"+t.event+"' timed out"),r.call(t,e,t)),t.cid&&this.transport.cancelPendingResponse(t.cid)},n.prototype._emit=function(t,e,r){var n=this;this.state==this.CLOSED&&this.connect();var o={event:t,callback:r},i=new h.Item;this.options.cloneData?o.data=l(e):o.data=e,(i.data=o).timeout=setTimeout(function(){n._handleEventAckTimeout(o,i)},this.ackTimeout),this._emitBuffer.append(i),this.state==this.OPEN&&this._flushEmitBuffer()},n.prototype.send=function(t){this.transport.send(t)},n.prototype.emit=function(t,e,r){null==this._localEvents[t]?this._emit(t,e,r):"error"==t?i.prototype.emit.call(this,t,e):(t=new y('The "'+t+'" event is reserved and cannot be emitted on a client socket'),this._onSCError(t))},n.prototype.publish=function(t,e,r){e={channel:this._decorateChannelName(t),data:e};this.emit("#publish",e,r)},n.prototype._triggerChannelSubscribe=function(t,e){var r,n=t.name;t.state!=t.SUBSCRIBED&&(r=t.state,t.state=t.SUBSCRIBED,r={channel:n,oldState:r,newState:t.state,subscriptionOptions:e},t.emit("subscribeStateChange",r),t.emit("subscribe",n,e),i.prototype.emit.call(this,"subscribeStateChange",r),i.prototype.emit.call(this,"subscribe",n,e))},n.prototype._triggerChannelSubscribeFail=function(t,e,r){var n=e.name,o=!e.waitForAuth||this.authState==this.AUTHENTICATED;e.state!=e.UNSUBSCRIBED&&o&&(e.state=e.UNSUBSCRIBED,e.emit("subscribeFail",t,n,r),i.prototype.emit.call(this,"subscribeFail",t,n,r))},n.prototype._cancelPendingSubscribeCallback=function(t){null!=t._pendingSubscriptionCid&&(this.transport.cancelPendingResponse(t._pendingSubscriptionCid),delete t._pendingSubscriptionCid)},n.prototype._decorateChannelName=function(t){return t=this.channelPrefix?this.channelPrefix+t:t},n.prototype._undecorateChannelName=function(t){return this.channelPrefix&&0==t.indexOf(this.channelPrefix)?t.replace(this.channelPrefix,""):t},n.prototype._trySubscribe=function(e){var r,n=this,t=!e.waitForAuth||this.authState==this.AUTHENTICATED;this.state==this.OPEN&&!this.preparingPendingSubscriptions&&null==e._pendingSubscriptionCid&&t&&(t={noTimeout:!0},r={channel:this._decorateChannelName(e.name)},e.waitForAuth&&(t.waitForAuth=!0,r.waitForAuth=t.waitForAuth),e.data&&(r.data=e.data),e.batch&&(t.batch=!0,r.batch=!0),e._pendingSubscriptionCid=this.transport.emit("#subscribe",r,t,function(t){delete e._pendingSubscriptionCid,t?n._triggerChannelSubscribeFail(t,e,r):n._triggerChannelSubscribe(e,r)}),i.prototype.emit.call(this,"subscribeRequest",e.name,r))},n.prototype.subscribe=function(t,e){var r=this.channels[t];return r?e&&r.setOptions(e):(r=new s(t,this,e),this.channels[t]=r),r.state==r.UNSUBSCRIBED&&(r.state=r.PENDING,this._trySubscribe(r)),r},n.prototype._triggerChannelUnsubscribe=function(t,e){var r=t.name,n=t.state;t.state=e||t.UNSUBSCRIBED,this._cancelPendingSubscribeCallback(t),n==t.SUBSCRIBED&&(n={channel:r,oldState:n,newState:t.state},t.emit("subscribeStateChange",n),t.emit("unsubscribe",r),i.prototype.emit.call(this,"subscribeStateChange",n),i.prototype.emit.call(this,"unsubscribe",r))},n.prototype._tryUnsubscribe=function(t){var e;this.state==this.OPEN&&(e={noTimeout:!0},t.batch&&(e.batch=!0),this._cancelPendingSubscribeCallback(t),t=this._decorateChannelName(t.name),this.transport.emit("#unsubscribe",t,e))},n.prototype.unsubscribe=function(t){t=this.channels[t];t&&t.state!=t.UNSUBSCRIBED&&(this._triggerChannelUnsubscribe(t),this._tryUnsubscribe(t))},n.prototype.channel=function(t,e){var r=this.channels[t];return r||(r=new s(t,this,e),this.channels[t]=r),r},n.prototype.destroyChannel=function(t){var e=this.channels[t];e&&(e.unwatch(),e.unsubscribe(),delete this.channels[t])},n.prototype.subscriptions=function(t){var e,r,n=[];for(r in this.channels)this.channels.hasOwnProperty(r)&&(e=this.channels[r],(t?e&&(e.state==e.SUBSCRIBED||e.state==e.PENDING):e&&e.state==e.SUBSCRIBED)&&n.push(r));return n},n.prototype.isSubscribed=function(t,e){t=this.channels[t];return e?!!t&&(t.state==t.SUBSCRIBED||t.state==t.PENDING):!!t&&t.state==t.SUBSCRIBED},n.prototype.processPendingSubscriptions=function(){var e=this;this.preparingPendingSubscriptions=!1;var t,r,n=[];for(t in this.channels)!this.channels.hasOwnProperty(t)||(r=this.channels[t]).state==r.PENDING&&n.push(r);n.sort(function(t,e){t=t.priority||0,e=e.priority||0;return e<t?-1:t<e?1:0}),n.forEach(function(t){e._trySubscribe(t)})},n.prototype.watch=function(t,e){if("function"!=typeof e)throw new d("No handler function was provided");this._channelEmitter.on(t,e)},n.prototype.unwatch=function(t,e){e?this._channelEmitter.removeListener(t,e):this._channelEmitter.removeAllListeners(t)},n.prototype.watchers=function(t){return this._channelEmitter.listeners(t)},w.exports=n}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},v("buffer").Buffer)},{"./auth":2,"./response":4,"./sctransport":6,"base-64":8,buffer:10,clone:11,"component-emitter":12,"linked-list":15,querystring:18,"sc-channel":19,"sc-errors":21,"sc-formatter":22}],6:[function(e,h,t){!function(t){var r,o=e("component-emitter"),i=e("./response").Response,n=e("querystring"),s=t.WebSocket?(r=t.WebSocket,function(t,e){return new r(t)}):(r=e("ws"),function(t,e){return new r(t,null,e)}),a=e("sc-errors"),c=a.TimeoutError,u=a.BadConnectionError,t=function(t,e,r){var n=this;this.state=this.CLOSED,this.auth=t,this.codec=e,this.options=r,this.connectTimeout=r.connectTimeout,this.pingTimeout=r.ackTimeout,this.pingTimeoutDisabled=!!r.pingTimeoutDisabled,this.callIdGenerator=r.callIdGenerator,this.authTokenName=r.authTokenName,this._pingTimeoutTicker=null,this._callbackMap={},this._batchSendList=[],this.state=this.CONNECTING;r=this.uri(),r=s(r,this.options);r.binaryType=this.options.binaryType,(this.socket=r).onopen=function(){n._onOpen()},r.onclose=function(t){var e=null==t.code?1005:t.code;n._onClose(e,t.reason)},r.onmessage=function(t,e){n._onMessage(t.data)},r.onerror=function(t){n.state===n.CONNECTING&&n._onClose(1006)},this._connectTimeoutRef=setTimeout(function(){n._onClose(4007),n.socket.close(4007)},this.connectTimeout)};t.prototype=Object.create(o.prototype),t.CONNECTING=t.prototype.CONNECTING="connecting",t.OPEN=t.prototype.OPEN="open",t.CLOSED=t.prototype.CLOSED="closed",t.prototype.uri=function(){var t,e=this.options.query||{},r=this.options.secure?"wss":"ws";return this.options.timestampRequests&&(e[this.options.timestampParam]=(new Date).getTime()),(e=n.encode(e)).length&&(e="?"+e),r+"://"+(this.options.host||(t="",this.options.port&&("wss"==r&&443!=this.options.port||"ws"==r&&80!=this.options.port)&&(t=":"+this.options.port),this.options.hostname+t))+this.options.path+e},t.prototype._onOpen=function(){var n=this;clearTimeout(this._connectTimeoutRef),this._resetPingTimeout(),this._handshake(function(t,e){var r;t?(r=e&&e.code?e.code:4003,n._onError(t),n._onClose(r,t.toString()),n.socket.close(r)):(n.state=n.OPEN,o.prototype.emit.call(n,"open",e),n._resetPingTimeout())})},t.prototype._handshake=function(n){var e=this;this.auth.loadToken(this.authTokenName,function(t,r){t?n(t):e.emit("#handshake",{authToken:r},{force:!0},function(t,e){e&&(e.authToken=r,e.authError&&(e.authError=a.hydrateError(e.authError))),n(t,e)})})},t.prototype._abortAllPendingEventsDueToBadConnection=function(t){for(var e in this._callbackMap){var r,n;this._callbackMap.hasOwnProperty(e)&&(r=this._callbackMap[e],delete this._callbackMap[e],clearTimeout(r.timeout),delete r.timeout,n="Event '"+r.event+"' was aborted due to a bad connection",e=new u(n,t),n=r.callback,delete r.callback,n.call(r,e,r))}},t.prototype._onClose=function(t,e){delete this.socket.onopen,delete this.socket.onclose,delete this.socket.onmessage,delete this.socket.onerror,clearTimeout(this._connectTimeoutRef),clearTimeout(this._pingTimeoutTicker),clearTimeout(this._batchTimeout),this.state==this.OPEN?(this.state=this.CLOSED,o.prototype.emit.call(this,"close",t,e),this._abortAllPendingEventsDueToBadConnection("disconnect")):this.state==this.CONNECTING&&(this.state=this.CLOSED,o.prototype.emit.call(this,"openAbort",t,e),this._abortAllPendingEventsDueToBadConnection("connectAbort"))},t.prototype._handleEventObject=function(t,e){var r,n;t&&null!=t.event?(n=new i(this,t.cid),o.prototype.emit.call(this,"event",t.event,t.data,n)):t&&null!=t.rid?(r=this._callbackMap[t.rid])&&(clearTimeout(r.timeout),delete r.timeout,delete this._callbackMap[t.rid],r.callback&&(n=a.hydrateError(t.error),r.callback(n,t.data))):o.prototype.emit.call(this,"event","raw",e)},t.prototype._onMessage=function(t){o.prototype.emit.call(this,"event","message",t);var e=this.decode(t);if("#1"==e)this._resetPingTimeout(),this.socket.readyState==this.socket.OPEN&&this.sendObject("#2");else if(Array.isArray(e))for(var r=e.length,n=0;n<r;n++)this._handleEventObject(e[n],t);else this._handleEventObject(e,t)},t.prototype._onError=function(t){o.prototype.emit.call(this,"error",t)},t.prototype._resetPingTimeout=function(){var t;this.pingTimeoutDisabled||(t=this,(new Date).getTime(),clearTimeout(this._pingTimeoutTicker),this._pingTimeoutTicker=setTimeout(function(){t._onClose(4e3),t.socket.close(4e3)},this.pingTimeout))},t.prototype.getBytesReceived=function(){return this.socket.bytesReceived},t.prototype.close=function(t,e){t=t||1e3,this.state==this.OPEN?(this.emit("#disconnect",{code:t,data:e}),this._onClose(t,e),this.socket.close(t)):this.state==this.CONNECTING&&(this._onClose(t,e),this.socket.close(t))},t.prototype.emitObject=function(t,e){var r={event:t.event,data:t.data};return t.callback&&(r.cid=t.cid=this.callIdGenerator(),this._callbackMap[t.cid]=t),this.sendObject(r,e),t.cid||null},t.prototype._handleEventAckTimeout=function(t){t.cid&&delete this._callbackMap[t.cid],delete t.timeout;var e,r=t.callback;r&&(delete t.callback,e=new c("Event response for '"+t.event+"' timed out"),r.call(t,e,t))},t.prototype.emit=function(t,e,r,n){var o,i=this;n?(o=r,a=n):r instanceof Function?(o={},a=r):o=r;var s={event:t,data:e,callback:a};a&&!o.noTimeout&&(s.timeout=setTimeout(function(){i._handleEventAckTimeout(s)},this.options.ackTimeout));var a=null;return a=this.state==this.OPEN||o.force?this.emitObject(s,o):a},t.prototype.cancelPendingResponse=function(t){delete this._callbackMap[t]},t.prototype.decode=function(t){return this.codec.decode(t)},t.prototype.encode=function(t){return this.codec.encode(t)},t.prototype.send=function(t){this.socket.readyState!=this.socket.OPEN?this._onClose(1005):this.socket.send(t)},t.prototype.serializeObject=function(t){var e,r;try{e=this.encode(t)}catch(t){this._onError(r=t)}return r?null:e},t.prototype.sendObjectBatch=function(t){var e=this;this._batchSendList.push(t),this._batchTimeout||(this._batchTimeout=setTimeout(function(){var t;delete e._batchTimeout,e._batchSendList.length&&(null!=(t=e.serializeObject(e._batchSendList))&&e.send(t),e._batchSendList=[])},this.options.pubSubBatchDuration||0))},t.prototype.sendObjectSingle=function(t){t=this.serializeObject(t);null!=t&&this.send(t)},t.prototype.sendObject=function(t,e){e&&e.batch?this.sendObjectBatch(t):this.sendObjectSingle(t)},h.exports.SCTransport=t}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./response":4,"component-emitter":12,querystring:18,"sc-errors":21,ws:7}],7:[function(t,e,r){var n="undefined"!=typeof WorkerGlobalScope?self:"undefined"!=typeof window&&window||function(){return this}(),o=n.WebSocket||n.MozWebSocket;function i(t,e,r){t=e?new o(t,e):new o(t);return t}o&&(i.prototype=o.prototype),e.exports=o?i:null},{}],8:[function(t,p,l){!function(c){!function(t){var e="object"==typeof l&&l,r="object"==typeof p&&p&&p.exports==e&&p,n="object"==typeof c&&c;n.global!==n&&n.window!==n||(t=n);var o=function(t){this.message=t};o.prototype=new Error,o.prototype.name="InvalidCharacterError";function u(t){throw new o(t)}var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=/[\t\n\f\r ]/g,i={encode:function(t){t=String(t),/[^\0-\xFF]/.test(t)&&u("The string to be encoded contains characters outside of the Latin1 range.");for(var e,r,n,o,i=t.length%3,s="",a=-1,c=t.length-i;++a<c;)e=t.charCodeAt(a)<<16,r=t.charCodeAt(++a)<<8,n=t.charCodeAt(++a),s+=h.charAt((o=e+r+n)>>18&63)+h.charAt(o>>12&63)+h.charAt(o>>6&63)+h.charAt(63&o);return 2==i?(e=t.charCodeAt(a)<<8,r=t.charCodeAt(++a),s+=h.charAt((o=e+r)>>10)+h.charAt(o>>4&63)+h.charAt(o<<2&63)+"="):1==i&&(o=t.charCodeAt(a),s+=h.charAt(o>>2)+h.charAt(o<<4&63)+"=="),s},decode:function(t){var e=(t=String(t).replace(a,"")).length;(e=e%4==0?(t=t.replace(/==?$/,"")).length:e)%4!=1&&!/[^+a-zA-Z0-9/]/.test(t)||u("Invalid character: the string to be decoded is not correctly encoded.");for(var r,n,o=0,i="",s=-1;++s<e;)n=h.indexOf(t.charAt(s)),r=o%4?64*r+n:n,o++%4&&(i+=String.fromCharCode(255&r>>(-2*o&6)));return i},version:"0.1.0"};if(0,e&&!e.nodeType)if(r)r.exports=i;else for(var s in i)i.hasOwnProperty(s)&&(e[s]=i[s]);else t.base64=i}(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(t,e,r){"use strict";r.byteLength=function(t){return 3*t.length/4-p(t)},r.toByteArray=function(t){var e,r,n,o,i,s=t.length;o=p(t),i=new h(3*s/4-o),r=0<o?s-4:s;var a=0;for(e=0;e<r;e+=4)n=u[t.charCodeAt(e)]<<18|u[t.charCodeAt(e+1)]<<12|u[t.charCodeAt(e+2)]<<6|u[t.charCodeAt(e+3)],i[a++]=n>>16&255,i[a++]=n>>8&255,i[a++]=255&n;2===o?(n=u[t.charCodeAt(e)]<<2|u[t.charCodeAt(e+1)]>>4,i[a++]=255&n):1===o&&(n=u[t.charCodeAt(e)]<<10|u[t.charCodeAt(e+1)]<<4|u[t.charCodeAt(e+2)]>>2,i[a++]=n>>8&255,i[a++]=255&n);return i},r.fromByteArray=function(t){for(var e,r=t.length,n=r%3,o="",i=[],s=0,a=r-n;s<a;s+=16383)i.push(function(t,e,r){for(var n,o=[],i=e;i<r;i+=3)n=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(255&t[i+2]),o.push(function(t){return c[t>>18&63]+c[t>>12&63]+c[t>>6&63]+c[63&t]}(n));return o.join("")}(t,s,a<s+16383?a:s+16383));1==n?(e=t[r-1],o+=c[e>>2],o+=c[e<<4&63],o+="=="):2==n&&(e=(t[r-2]<<8)+t[r-1],o+=c[e>>10],o+=c[e>>4&63],o+=c[e<<2&63],o+="=");return i.push(o),i.join("")};for(var c=[],u=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,i=n.length;o<i;++o)c[o]=n[o],u[n.charCodeAt(o)]=o;function p(t){var e=t.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},{}],10:[function(t,e,r){"use strict";var a=t("base64-js"),i=t("ieee754");r.Buffer=p,r.SlowBuffer=function(t){+t!=t&&(t=0);return p.alloc(+t)},r.INSPECT_MAX_BYTES=50;var n=2147483647;function o(t){if(n<t)throw new RangeError("Invalid typed array length");t=new Uint8Array(t);return t.__proto__=p.prototype,t}function p(t,e,r){if("number"!=typeof t)return s(t,e,r);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return u(t)}function s(t,e,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return N(t)||t&&N(t.buffer)?function(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');r=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r);return r.__proto__=p.prototype,r}(t,e,r):"string"==typeof t?function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!p.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|f(t,e),n=o(r),e=n.write(t,e);e!==r&&(n=n.slice(0,e));return n}(t,e):function(t){if(p.isBuffer(t)){var e=0|l(t.length),r=o(e);return 0===r.length?r:(t.copy(r,0,0,e),r)}if(t){if(ArrayBuffer.isView(t)||"length"in t)return"number"!=typeof t.length||x(t.length)?o(0):h(t);if("Buffer"===t.type&&Array.isArray(t.data))return h(t.data)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object.")}(t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('"size" argument must not be negative')}function u(t){return c(t),o(t<0?0:0|l(t))}function h(t){for(var e=t.length<0?0:0|l(t.length),r=o(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function l(t){if(n<=t)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|t}function f(t,e){if(p.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||N(t))return t.byteLength;var r=(t="string"!=typeof t?""+t:t).length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return O(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return I(t).length;default:if(n)return O(t).length;e=(""+e).toLowerCase(),n=!0}}function d(t,e,r){var n,o,i,s=!1;if((e=void 0===e||e<0?0:e)>this.length)return"";if((r=void 0===r||r>this.length?this.length:r)<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t=t||"utf8";;)switch(t){case"hex":return function(t,e,r){var n=t.length;(!e||e<0)&&(e=0);(!r||r<0||n<r)&&(r=n);for(var o="",i=e;i<r;++i)o+=function(t){return t<16?"0"+t.toString(16):t.toString(16)}(t[i]);return o}(this,e,r);case"utf8":case"utf-8":return v(this,e,r);case"ascii":return function(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(127&t[o]);return n}(this,e,r);case"latin1":case"binary":return function(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(t[o]);return n}(this,e,r);case"base64":return n=this,i=r,0===(o=e)&&i===n.length?a.fromByteArray(n):a.fromByteArray(n.slice(o,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,r){for(var n=t.slice(e,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}(this,e,r);default:if(s)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),s=!0}}function y(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function g(t,e,r,n,o){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),(r=(r=x(r=+r)?o?0:t.length-1:r)<0?t.length+r:r)>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof e&&(e=p.from(e,n)),p.isBuffer(e))return 0===e.length?-1:m(t,e,r,n,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?(o?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(t,e,r):m(t,[e],r,n,o);throw new TypeError("val must be string, number or Buffer")}function m(t,e,r,n,o){var i=1,s=t.length,a=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s/=i=2,a/=2,r/=2}function c(t,e){return 1===i?t[e]:t.readUInt16BE(e*i)}if(o)for(var u=-1,h=r;h<s;h++)if(c(t,h)===c(e,-1===u?0:h-u)){if(h-(u=-1===u?h:u)+1===a)return u*i}else-1!==u&&(h-=h-u),u=-1;else for(h=r=s<r+a?s-a:r;0<=h;h--){for(var p=!0,l=0;l<a;l++)if(c(t,h+l)!==c(e,l)){p=!1;break}if(p)return h}return-1}function b(t,e,r,n){return B(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function E(t,e,r,n){return B(function(t,e){for(var r,n,o=[],i=0;i<t.length&&!((e-=2)<0);++i)n=t.charCodeAt(i),r=n>>8,n=n%256,o.push(n),o.push(r);return o}(e,t.length-r),t,r,n)}function v(t,e,r){r=Math.min(t.length,r);for(var n=[],o=e;o<r;){var i,s,a,c,u=t[o],h=null,p=239<u?4:223<u?3:191<u?2:1;if(o+p<=r)switch(p){case 1:u<128&&(h=u);break;case 2:128==(192&(i=t[o+1]))&&127<(c=(31&u)<<6|63&i)&&(h=c);break;case 3:i=t[o+1],s=t[o+2],128==(192&i)&&128==(192&s)&&2047<(c=(15&u)<<12|(63&i)<<6|63&s)&&(c<55296||57343<c)&&(h=c);break;case 4:i=t[o+1],s=t[o+2],a=t[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&65535<(c=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)&&c<1114112&&(h=c)}null===h?(h=65533,p=1):65535<h&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),o+=p}return function(t){var e=t.length;if(e<=w)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=w));return r}(n)}r.kMaxLength=n,(p.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(t){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(p.prototype,"parent",{get:function(){if(this instanceof p)return this.buffer}}),Object.defineProperty(p.prototype,"offset",{get:function(){if(this instanceof p)return this.byteOffset}}),"undefined"!=typeof Symbol&&Symbol.species&&p[Symbol.species]===p&&Object.defineProperty(p,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),p.poolSize=8192,p.from=s,p.prototype.__proto__=Uint8Array.prototype,p.__proto__=Uint8Array,p.alloc=function(t,e,r){return e=e,r=r,c(t=t),!(t<=0)&&void 0!==e?"string"==typeof r?o(t).fill(e,r):o(t).fill(e):o(t)},p.allocUnsafe=u,p.allocUnsafeSlow=u,p.isBuffer=function(t){return null!=t&&!0===t._isBuffer},p.compare=function(t,e){if(!p.isBuffer(t)||!p.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,o=0,i=Math.min(r,n);o<i;++o)if(t[o]!==e[o]){r=t[o],n=e[o];break}return r<n?-1:n<r?1:0},p.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return p.alloc(0);if(void 0===e)for(o=e=0;o<t.length;++o)e+=t[o].length;for(var r=p.allocUnsafe(e),n=0,o=0;o<t.length;++o){var i=t[o];if(ArrayBuffer.isView(i)&&(i=p.from(i)),!p.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,n),n+=i.length}return r},p.byteLength=f,p.prototype._isBuffer=!0,p.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},p.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},p.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},p.prototype.toLocaleString=p.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?v(this,0,t):d.apply(this,arguments)},p.prototype.equals=function(t){if(!p.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===p.compare(this,t)},p.prototype.inspect=function(){var t="",e=r.INSPECT_MAX_BYTES;return 0<this.length&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},p.prototype.compare=function(t,e,r,n,o){if(!p.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),(e=void 0===e?0:e)<0||r>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(o<=n&&r<=e)return 0;if(o<=n)return-1;if(r<=e)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(n>>>=0),s=(r>>>=0)-(e>>>=0),a=Math.min(i,s),c=this.slice(n,o),u=t.slice(e,r),h=0;h<a;++h)if(c[h]!==u[h]){i=c[h],s=u[h];break}return i<s?-1:s<i?1:0},p.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},p.prototype.indexOf=function(t,e,r){return g(this,t,e,r,!0)},p.prototype.lastIndexOf=function(t,e,r){return g(this,t,e,r,!1)},p.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-e;if((void 0===r||o<r)&&(r=o),0<t.length&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n=n||"utf8";for(var i,s,a,c=!1;;)switch(n){case"hex":return function(t,e,r,n){r=Number(r)||0;var o=t.length-r;(!n||o<(n=Number(n)))&&(n=o),(o=e.length)/2<n&&(n=o/2);for(var i=0;i<n;++i){var s=parseInt(e.substr(2*i,2),16);if(x(s))return i;t[r+i]=s}return i}(this,t,e,r);case"utf8":case"utf-8":return s=e,a=r,B(O(t,(i=this).length-s),i,s,a);case"ascii":return b(this,t,e,r);case"latin1":case"binary":return b(this,t,e,r);case"base64":return i=this,s=e,a=r,B(I(t),i,s,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,r);default:if(c)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),c=!0}},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var w=4096;function k(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(r<t+e)throw new RangeError("Trying to access beyond buffer length")}function T(t,e,r,n,o,i){if(!p.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(o<e||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function S(t,e,r,n){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function _(t,e,r,n,o){return e=+e,r>>>=0,o||S(t,0,r,4),i.write(t,e,r,n,23,4),r+4}function C(t,e,r,n,o){return e=+e,r>>>=0,o||S(t,0,r,8),i.write(t,e,r,n,52,8),r+8}p.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),e<t&&(e=t);e=this.subarray(t,e);return e.__proto__=p.prototype,e},p.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||k(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n},p.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||k(t,e,this.length);for(var n=this[t+--e],o=1;0<e&&(o*=256);)n+=this[t+--e]*o;return n},p.prototype.readUInt8=function(t,e){return t>>>=0,e||k(t,1,this.length),this[t]},p.prototype.readUInt16LE=function(t,e){return t>>>=0,e||k(t,2,this.length),this[t]|this[t+1]<<8},p.prototype.readUInt16BE=function(t,e){return t>>>=0,e||k(t,2,this.length),this[t]<<8|this[t+1]},p.prototype.readUInt32LE=function(t,e){return t>>>=0,e||k(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},p.prototype.readUInt32BE=function(t,e){return t>>>=0,e||k(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},p.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||k(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return(o*=128)<=n&&(n-=Math.pow(2,8*e)),n},p.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||k(t,e,this.length);for(var n=e,o=1,i=this[t+--n];0<n&&(o*=256);)i+=this[t+--n]*o;return(o*=128)<=i&&(i-=Math.pow(2,8*e)),i},p.prototype.readInt8=function(t,e){return t>>>=0,e||k(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},p.prototype.readInt16LE=function(t,e){t>>>=0,e||k(t,2,this.length);t=this[t]|this[t+1]<<8;return 32768&t?4294901760|t:t},p.prototype.readInt16BE=function(t,e){t>>>=0,e||k(t,2,this.length);t=this[t+1]|this[t]<<8;return 32768&t?4294901760|t:t},p.prototype.readInt32LE=function(t,e){return t>>>=0,e||k(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},p.prototype.readInt32BE=function(t,e){return t>>>=0,e||k(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},p.prototype.readFloatLE=function(t,e){return t>>>=0,e||k(t,4,this.length),i.read(this,t,!0,23,4)},p.prototype.readFloatBE=function(t,e){return t>>>=0,e||k(t,4,this.length),i.read(this,t,!1,23,4)},p.prototype.readDoubleLE=function(t,e){return t>>>=0,e||k(t,8,this.length),i.read(this,t,!0,52,8)},p.prototype.readDoubleBE=function(t,e){return t>>>=0,e||k(t,8,this.length),i.read(this,t,!1,52,8)},p.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||T(this,t,e,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[e]=255&t;++i<r&&(o*=256);)this[e+i]=t/o&255;return e+r},p.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||T(this,t,e,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[e+o]=255&t;0<=--o&&(i*=256);)this[e+o]=t/i&255;return e+r},p.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,1,255,0),this[e]=255&t,e+1},p.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},p.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},p.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},p.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},p.prototype.writeIntLE=function(t,e,r,n){t=+t,e>>>=0,n||T(this,t,e,r,(n=Math.pow(2,8*r-1))-1,-n);var o=0,i=1,s=0;for(this[e]=255&t;++o<r&&(i*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+r},p.prototype.writeIntBE=function(t,e,r,n){t=+t,e>>>=0,n||T(this,t,e,r,(n=Math.pow(2,8*r-1))-1,-n);var o=r-1,i=1,s=0;for(this[e+o]=255&t;0<=--o&&(i*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+r},p.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,1,127,-128),this[e]=255&(t=t<0?255+t+1:t),e+1},p.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},p.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},p.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},p.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||T(this,t,e,4,2147483647,-2147483648),this[e]=(t=t<0?4294967295+t+1:t)>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},p.prototype.writeFloatLE=function(t,e,r){return _(this,t,e,!0,r)},p.prototype.writeFloatBE=function(t,e,r){return _(this,t,e,!1,r)},p.prototype.writeDoubleLE=function(t,e,r){return C(this,t,e,!0,r)},p.prototype.writeDoubleBE=function(t,e,r){return C(this,t,e,!1,r)},p.prototype.copy=function(t,e,r,n){if(!p.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r=r||0,n||0===n||(n=this.length),e>=t.length&&(e=t.length),(n=0<n&&n<r?r:n)===r)return 0;if(0===t.length||0===this.length)return 0;if((e=e||0)<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length);var o=(n=t.length-e<n-r?t.length-e+r:n)-r;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,r,n);else if(this===t&&r<e&&e<n)for(var i=o-1;0<=i;--i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,n),e);return o},p.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!p.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var o;1===t.length&&(o=t.charCodeAt(0),("utf8"===n&&o<128||"latin1"===n)&&(t=o))}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var i;if(e>>>=0,r=void 0===r?this.length:r>>>0,"number"==typeof(t=t||0))for(i=e;i<r;++i)this[i]=t;else{var s=p.isBuffer(t)?t:new p(t,n),a=s.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<r-e;++i)this[i+e]=s[i%a]}return this};var A=/[^+/0-9A-Za-z-_]/g;function O(t,e){var r;e=e||1/0;for(var n=t.length,o=null,i=[],s=0;s<n;++s){if(55295<(r=t.charCodeAt(s))&&r<57344){if(!o){if(56319<r){-1<(e-=3)&&i.push(239,191,189);continue}if(s+1===n){-1<(e-=3)&&i.push(239,191,189);continue}o=r;continue}if(r<56320){-1<(e-=3)&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&-1<(e-=3)&&i.push(239,191,189);if(o=null,r<128){if(--e<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function I(t){return a.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(A,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function B(t,e,r,n){for(var o=0;o<n&&!(o+r>=e.length||o>=t.length);++o)e[o+r]=t[o];return o}function N(t){return t instanceof ArrayBuffer||null!=t&&null!=t.constructor&&"ArrayBuffer"===t.constructor.name&&"number"==typeof t.byteLength}function x(t){return t!=t}},{"base64-js":9,ieee754:13}],11:[function(t,e,r){!function(_){var t=function(){"use strict";function E(t,e){return null!=e&&t instanceof e}var v,w,k;try{v=Map}catch(t){v=function(){}}try{w=Set}catch(t){w=function(){}}try{k=Promise}catch(t){k=function(){}}function T(t,f,e,d,y){"object"==typeof f&&(e=f.depth,d=f.prototype,y=f.includeNonEnumerable,f=f.circular);var g=[],m=[],b=void 0!==_;return void 0===f&&(f=!0),function n(t,o){if(null===t)return null;if(0===o)return t;var r,e,i;if("object"!=typeof t)return t;if(E(t,v))r=new v;else if(E(t,w))r=new w;else if(E(t,k))r=new k(function(e,r){t.then(function(t){e(n(t,o-1))},function(t){r(n(t,o-1))})});else if(T.__isArray(t))r=[];else if(T.__isRegExp(t))r=new RegExp(t.source,S(t)),t.lastIndex&&(r.lastIndex=t.lastIndex);else if(T.__isDate(t))r=new Date(t.getTime());else{if(b&&_.isBuffer(t))return r=new _(t.length),t.copy(r),r;E(t,Error)?r=Object.create(t):void 0===d?(e=Object.getPrototypeOf(t),r=Object.create(e)):(r=Object.create(d),e=d)}if(f){var s=g.indexOf(t);if(-1!=s)return m[s];g.push(t),m.push(r)}for(c in E(t,v)&&t.forEach(function(t,e){e=n(e,o-1),t=n(t,o-1),r.set(e,t)}),E(t,w)&&t.forEach(function(t){t=n(t,o-1),r.add(t)}),t)(i=e?Object.getOwnPropertyDescriptor(e,c):i)&&null==i.set||(r[c]=n(t[c],o-1));if(Object.getOwnPropertySymbols)for(var a=Object.getOwnPropertySymbols(t),c=0;c<a.length;c++){var u=a[c];(p=Object.getOwnPropertyDescriptor(t,u))&&!p.enumerable&&!y||(r[u]=n(t[u],o-1),p.enumerable||Object.defineProperty(r,u,{enumerable:!1}))}if(y)for(var h=Object.getOwnPropertyNames(t),c=0;c<h.length;c++){var p,l=h[c];(p=Object.getOwnPropertyDescriptor(t,l))&&p.enumerable||(r[l]=n(t[l],o-1),Object.defineProperty(r,l,{enumerable:!1}))}return r}(t,e=void 0===e?1/0:e)}function e(t){return Object.prototype.toString.call(t)}function S(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return T.clonePrototype=function(t){if(null===t)return null;function e(){}return e.prototype=t,new e},T.__objToStr=e,T.__isDate=function(t){return"object"==typeof t&&"[object Date]"===e(t)},T.__isArray=function(t){return"object"==typeof t&&"[object Array]"===e(t)},T.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===e(t)},T.__getRegExpFlags=S,T}();"object"==typeof e&&e.exports&&(e.exports=t)}.call(this,t("buffer").Buffer)},{buffer:10}],12:[function(t,e,r){function n(t){if(t)return function(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}(t)}void 0!==e&&(e.exports=n),n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},n.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<n.length;o++)if((r=n[o])===e||r.fn===e){n.splice(o,1);break}return this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks["$"+t];if(r)for(var n=0,o=(r=r.slice(0)).length;n<o;++n)r[n].apply(this,e);return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],13:[function(t,e,r){r.read=function(t,e,r,n,o){var i,s,a=8*o-n-1,c=(1<<a)-1,u=c>>1,h=-7,p=r?o-1:0,l=r?-1:1,r=t[e+p];for(p+=l,i=r&(1<<-h)-1,r>>=-h,h+=a;0<h;i=256*i+t[e+p],p+=l,h-=8);for(s=i&(1<<-h)-1,i>>=-h,h+=n;0<h;s=256*s+t[e+p],p+=l,h-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(r?-1:1);s+=Math.pow(2,n),i-=u}return(r?-1:1)*s*Math.pow(2,i-n)},r.write=function(t,e,r,n,o,i){var s,a,c=8*i-o-1,u=(1<<c)-1,h=u>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,l=n?0:i-1,f=n?1:-1,i=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(n=Math.pow(2,-s))<1&&(s--,n*=2),2<=(e+=1<=s+h?p/n:p*Math.pow(2,1-h))*n&&(s++,n/=2),u<=s+h?(a=0,s=u):1<=s+h?(a=(e*n-1)*Math.pow(2,o),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,o),s=0));8<=o;t[r+l]=255&a,l+=f,a/=256,o-=8);for(s=s<<o|a,c+=o;0<c;t[r+l]=255&s,l+=f,s/=256,c-=8);t[r+l-f]|=128*i}},{}],14:[function(t,e,r){"use strict";var o;function n(){if(arguments.length)return n.from(arguments)}function i(){}o="An argument without append, prepend, or detach methods was given to `List",s=n.prototype,n.of=function(){return n.from.call(this,arguments)},n.from=function(t){var e,r,n,o=new this;if(t&&(e=t.length))for(r=-1;++r<e;)null!=(n=t[r])&&o.append(n);return o},s.head=null,s.tail=null,s.toArray=function(){for(var t=this.head,e=[];t;)e.push(t),t=t.next;return e},s.prepend=function(t){if(!t)return!1;if(!t.append||!t.prepend||!t.detach)throw new Error(o+"#prepend`.");var e=this.head;return e?e.prepend(t):(t.detach(),(t.list=this).head=t)},s.append=function(t){if(!t)return!1;if(!t.append||!t.prepend||!t.detach)throw new Error(o+"#append`.");var e=this.tail;return(e=e||this.head)?e.append(t):(t.detach(),(t.list=this).head=t)};var s=(n.Item=i).prototype;s.next=null,s.prev=null,s.list=null,s.detach=function(){var t=this,e=t.list,r=t.prev,n=t.next;return e&&(e.tail===t&&(e.tail=r),e.head===t&&(e.head=n),e.tail===e.head&&(e.tail=null),r&&(r.next=n),n&&(n.prev=r),t.prev=t.next=t.list=null),t},s.prepend=function(t){if(!(t&&t.append&&t.prepend&&t.detach))throw new Error(o+"Item#prepend`.");var e=this,r=e.list,n=e.prev;return!!r&&(t.detach(),n&&((t.prev=n).next=t),t.next=e,t.list=r,e.prev=t,e===r.head&&(r.head=t),r.tail||(r.tail=e),t)},s.append=function(t){if(!(t&&t.append&&t.prepend&&t.detach))throw new Error(o+"Item#append`.");var e=this,r=e.list,n=e.next;return!!r&&(t.detach(),n&&((t.next=n).prev=t),t.prev=e,t.list=r,e.next=t,e!==r.tail&&r.tail||(r.tail=t),t)},e.exports=n},{}],15:[function(t,e,r){"use strict";e.exports=t("./_source/linked-list.js")},{"./_source/linked-list.js":14}],16:[function(t,e,r){"use strict";e.exports=function(t,e,r,n){r=r||"=";var o={};if("string"!=typeof t||0===t.length)return o;var i=/\+/g;t=t.split(e=e||"&");e=1e3;n&&"number"==typeof n.maxKeys&&(e=n.maxKeys);var s=t.length;0<e&&e<s&&(s=e);for(var a=0;a<s;++a){var c,u=t[a].replace(i,"%20"),h=u.indexOf(r),h=0<=h?(c=u.substr(0,h),u.substr(h+1)):(c=u,""),u=decodeURIComponent(c),h=decodeURIComponent(h);Object.prototype.hasOwnProperty.call(o,u)?p(o[u])?o[u].push(h):o[u]=[o[u],h]:o[u]=h}return o};var p=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],17:[function(t,e,r){"use strict";function i(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}e.exports=function(r,n,o,t){return n=n||"&",o=o||"=","object"==typeof(r=null===r?void 0:r)?a(c(r),function(t){var e=encodeURIComponent(i(t))+o;return s(r[t])?a(r[t],function(t){return e+encodeURIComponent(i(t))}).join(n):e+encodeURIComponent(i(r[t]))}).join(n):t?encodeURIComponent(i(t))+o+encodeURIComponent(i(r)):""};var s=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function a(t,e){if(t.map)return t.map(e);for(var r=[],n=0;n<t.length;n++)r.push(e(t[n],n));return r}var c=Object.keys||function(t){var e,r=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&r.push(e);return r}},{}],18:[function(t,e,r){"use strict";r.decode=r.parse=t("./decode"),r.encode=r.stringify=t("./encode")},{"./decode":16,"./encode":17}],19:[function(t,e,r){var n=t("component-emitter"),t=function(t,e,r){n.call(this),this.PENDING="pending",this.SUBSCRIBED="subscribed",this.UNSUBSCRIBED="unsubscribed",this.name=t,this.state=this.UNSUBSCRIBED,this.client=e,this.options=r||{},this.setOptions(this.options)};(t.prototype=Object.create(n.prototype)).setOptions=function(t){this.waitForAuth=(t=t||{}).waitForAuth||!1,this.batch=t.batch||!1,void 0!==t.data&&(this.data=t.data)},t.prototype.getState=function(){return this.state},t.prototype.subscribe=function(t){this.client.subscribe(this.name,t)},t.prototype.unsubscribe=function(){this.client.unsubscribe(this.name)},t.prototype.isSubscribed=function(t){return this.client.isSubscribed(this.name,t)},t.prototype.publish=function(t,e){this.client.publish(this.name,t,e)},t.prototype.watch=function(t){this.client.watch(this.name,t)},t.prototype.unwatch=function(t){this.client.unwatch(this.name,t)},t.prototype.watchers=function(){return this.client.watchers(this.name)},t.prototype.destroy=function(){this.client.destroyChannel(this.name)},e.exports.SCChannel=t},{"component-emitter":12}],20:[function(t,e,r){e.exports=function(t){var s=[],a=[];return function t(e,r){var n,o,i;if("object"!=typeof e||null===e||e instanceof Boolean||e instanceof Date||e instanceof Number||e instanceof RegExp||e instanceof String)return e;for(n=0;n<s.length;n+=1)if(s[n]===e)return{$ref:a[n]};if(s.push(e),a.push(r),"[object Array]"===Object.prototype.toString.apply(e))for(i=[],n=0;n<e.length;n+=1)i[n]=t(e[n],r+"["+n+"]");else for(o in i={},e)Object.prototype.hasOwnProperty.call(e,o)&&(i[o]=t(e[o],r+"["+JSON.stringify(o)+"]"));return i}(t,"$")}},{}],21:[function(t,e,r){var o=t("./decycle"),n=function(){return!this}();function i(t,e){this.name="AuthTokenExpiredError",this.message=t,this.expiry=e,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function s(t){this.name="AuthTokenInvalidError",this.message=t,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function a(t,e){this.name="AuthTokenNotBeforeError",this.message=t,this.date=e,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function c(t){this.name="AuthTokenError",this.message=t,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function u(t,e){this.name="SilentMiddlewareBlockedError",this.message=t,this.type=e,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function h(t){this.name="InvalidActionError",this.message=t,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function p(t){this.name="InvalidArgumentsError",this.message=t,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function l(t){this.name="InvalidOptionsError",this.message=t,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function f(t){this.name="InvalidMessageError",this.message=t,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function d(t,e){this.name="SocketProtocolError",this.message=t,this.code=e,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function y(t){this.name="ServerProtocolError",this.message=t,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function g(t){this.name="HTTPServerError",this.message=t,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function m(t){this.name="ResourceLimitError",this.message=t,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function b(t){this.name="TimeoutError",this.message=t,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function E(t,e){this.name="BadConnectionError",this.message=t,this.type=e,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function v(t){this.name="BrokerError",this.message=t,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function w(t,e){this.name="ProcessExitError",this.message=t,this.code=e,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}function k(t){this.name="UnknownError",this.message=t,Error.captureStackTrace&&!n?Error.captureStackTrace(this,arguments.callee):this.stack=(new Error).stack}i.prototype=Object.create(Error.prototype),s.prototype=Object.create(Error.prototype),a.prototype=Object.create(Error.prototype),c.prototype=Object.create(Error.prototype),u.prototype=Object.create(Error.prototype),h.prototype=Object.create(Error.prototype),p.prototype=Object.create(Error.prototype),l.prototype=Object.create(Error.prototype),f.prototype=Object.create(Error.prototype),d.prototype=Object.create(Error.prototype),y.prototype=Object.create(Error.prototype),g.prototype=Object.create(Error.prototype),m.prototype=Object.create(Error.prototype),b.prototype=Object.create(Error.prototype),E.prototype=Object.create(Error.prototype),v.prototype=Object.create(Error.prototype),w.prototype=Object.create(Error.prototype),k.prototype=Object.create(Error.prototype),e.exports={AuthTokenExpiredError:i,AuthTokenInvalidError:s,AuthTokenNotBeforeError:a,AuthTokenError:c,SilentMiddlewareBlockedError:u,InvalidActionError:h,InvalidArgumentsError:p,InvalidOptionsError:l,InvalidMessageError:f,SocketProtocolError:d,ServerProtocolError:y,HTTPServerError:g,ResourceLimitError:m,TimeoutError:b,BadConnectionError:E,BrokerError:v,ProcessExitError:w,UnknownError:k},e.exports.socketProtocolErrorStatuses={1001:"Socket was disconnected",1002:"A WebSocket protocol error was encountered",1003:"Server terminated socket because it received invalid data",1005:"Socket closed without status code",1006:"Socket hung up",1007:"Message format was incorrect",1008:"Encountered a policy violation",1009:"Message was too big to process",1010:"Client ended the connection because the server did not comply with extension requirements",1011:"Server encountered an unexpected fatal condition",4e3:"Server ping timed out",4001:"Client pong timed out",4002:"Server failed to sign auth token",4003:"Failed to complete handshake",4004:"Client failed to save auth token",4005:"Did not receive #handshake from client before timeout",4006:"Failed to bind socket to message broker",4007:"Client connection establishment timed out",4008:"Server rejected handshake from client"},e.exports.socketProtocolIgnoreStatuses={1e3:"Socket closed normally",1001:"Socket hung up"};var T={domain:1,domainEmitter:1,domainThrown:1};e.exports.dehydrateError=function(t,e){var r;if(t&&"object"==typeof t)for(var n in r={message:t.message},e&&(r.stack=t.stack),t)T[n]||(r[n]=t[n]);else r="function"==typeof t?"[function "+(t.name||"anonymous")+"]":t;return o(r)},e.exports.hydrateError=function(t){var e=null;if(null!=t)if("object"==typeof t)for(var r in e=new Error(t.message),t)t.hasOwnProperty(r)&&(e[r]=t[r]);else e=t;return e},e.exports.decycle=o},{"./decycle":20}],22:[function(t,o,e){!function(n){function e(t,e){if(n.ArrayBuffer&&e instanceof n.ArrayBuffer)return{base64:!0,data:function(t){for(var e=new Uint8Array(t),r=e.length,n="",o=0;o<r;o+=3)n+=i[e[o]>>2],n+=i[(3&e[o])<<4|e[o+1]>>4],n+=i[(15&e[o+1])<<2|e[o+2]>>6],n+=i[63&e[o+2]];return r%3==2?n=n.substring(0,n.length-1)+"=":r%3==1&&(n=n.substring(0,n.length-2)+"=="),n}(e)};if(n.Buffer){if(e instanceof n.Buffer)return{base64:!0,data:e.toString("base64")};if(e&&"Buffer"===e.type&&Array.isArray(e.data)){var r=n.Buffer.from?n.Buffer.from(e.data):new n.Buffer(e.data);return{base64:!0,data:r.toString("base64")}}}return e}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=/^[ \n\r\t]*[{\[]/;o.exports.decode=function(t){if(null==t)return null;if("#1"===t||"#2"===t)return t;t=t.toString();if(!r.test(t))return t;try{return JSON.parse(t)}catch(t){}return t},o.exports.encode=function(t){return"#1"===t||"#2"===t?t:JSON.stringify(t,e)}}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],23:[function(t,e,r){var n=t("./v1"),o=t("./v4"),t=o;t.v1=n,t.v4=o,e.exports=t},{"./v1":26,"./v4":27}],24:[function(t,e,r){for(var n=[],o=0;o<256;++o)n[o]=(o+256).toString(16).substr(1);e.exports=function(t,e){return e=e||0,n[t[e++]]+n[t[e++]]+n[t[e++]]+n[t[e++]]+"-"+n[t[e++]]+n[t[e++]]+"-"+n[t[e++]]+n[t[e++]]+"-"+n[t[e++]]+n[t[e++]]+"-"+n[t[e++]]+n[t[e++]]+n[t[e++]]+n[t[e++]]+n[t[e++]]+n[t[e++]]}},{}],25:[function(t,e,r){var n,o,i="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);i?(n=new Uint8Array(16),e.exports=function(){return i(n),n}):(o=new Array(16),e.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o})},{}],26:[function(t,e,r){var h,p,l=t("./lib/rng"),f=t("./lib/bytesToUuid"),d=0,y=0;e.exports=function(t,e,r){var n=e&&r||0,o=e||[],i=(t=t||{}).node||h,s=void 0!==t.clockseq?t.clockseq:p;null!=i&&null!=s||(c=l(),null==i&&(i=h=[1|c[0],c[1],c[2],c[3],c[4],c[5]]),null==s&&(s=p=16383&(c[6]<<8|c[7])));var a=void 0!==t.msecs?t.msecs:(new Date).getTime(),r=void 0!==t.nsecs?t.nsecs:y+1,c=a-d+(r-y)/1e4;if(c<0&&void 0===t.clockseq&&(s=s+1&16383),1e4<=(r=(c<0||d<a)&&void 0===t.nsecs?0:r))throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");d=a,p=s,r=(1e4*(268435455&(a+=122192928e5))+(y=r))%4294967296,o[n++]=r>>>24&255,o[n++]=r>>>16&255,o[n++]=r>>>8&255,o[n++]=255&r,a=a/4294967296*1e4&268435455,o[n++]=a>>>8&255,o[n++]=255&a,o[n++]=a>>>24&15|16,o[n++]=a>>>16&255,o[n++]=s>>>8|128,o[n++]=255&s;for(var u=0;u<6;++u)o[n+u]=i[u];return e||f(o)}},{"./lib/bytesToUuid":24,"./lib/rng":25}],27:[function(t,e,r){var s=t("./lib/rng"),a=t("./lib/bytesToUuid");e.exports=function(t,e,r){var n=e&&r||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var o=(t=t||{}).random||(t.rng||s)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e)for(var i=0;i<16;++i)e[n+i]=o[i];return e||a(o)}},{"./lib/bytesToUuid":24,"./lib/rng":25}]},{},[1])(1)}),function(){var t={hostname:lh_inst.nodejsHelperOptions.hostname,path:lh_inst.nodejsHelperOptions.path,authTokenName:"socketCluster.authToken_vi"};""!=lh_inst.nodejsHelperOptions.port&&(t.port=parseInt(lh_inst.nodejsHelperOptions.port)),1==lh_inst.nodejsHelperOptions.secure&&(t.secure=!0);var e=socketCluster.connect(t);function r(){var t=e.subscribe("uo_"+lh_inst.cookieDataPers.vid);t.on("subscribeFail",function(t){console.error("Failed to subscribe to the sample channel due to error: "+t)}),t.watch(function(t){"check_message"==t.op&&lh_inst.startNewMessageCheckSingle()})}e.on("error",function(t){console.error(t)});var n="uo_"+lh_inst.cookieDataPers.vid;e.on("connect",function(t){t.isAuthenticated?r():e.emit("login",{hash:lh_inst.nodejsHelperOptions.hash,chanelName:n},function(t){t?console.log(t):r()})})}();